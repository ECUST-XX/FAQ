## MYSQL的innodb引擎中，聚簇索引和二级索引有什么不同

### 面试高级PHP职位，不会有太多关于PHP语言本身层面的内容，mysql的篇幅往往比PHP还要大，难度可能更大，原因我想可能更多是因为web开发中滥用mysql导致卡顿...所以，索引很重要

#### 聚簇索引与非聚簇索引

* 聚簇索引并不是一种索引类型而是一种数据存储方式,即b+tree的子节点是表中相应的数据(innodb),而不是指向数据的指针(myisam)

* 非聚簇索引一般是指二级索引,即除去聚簇索引外的索引(数据结构依旧是b+tree),其子节点是数据的主键(innodb)或者指向数据的指针(myisam)

* 聚簇索引一般作为innodb的主键索引(只有一个),查询时直接使用即可,而innodb的非聚簇索引在查询时,其实需要再次根据主键使用聚簇索引获取数据(没有使用覆盖索引优化)

* 聚簇索引的索引值应当尽量自增且使用数字类型,保证自增是为了在数据插入时减少调整b+tree结构的消耗,使用数字类型是为了减少非聚簇索引子节点数据容量的负担

* 聚簇索引将子节点用来存储数据可以提高获取连续数据的效率(对机械盘效果明显)

* 当使用覆盖索引(一种索引优化策略)进行查询时可以直接获取子节点的主键,此时不用再去查询聚簇索引

#### 常见索引类型

* b-tree索引是最常用的索引结构,innodb使用的是其变种b+tree

* hash索引常见于memory存储引擎,可以通过b-tree进行模拟

* r-tree索引即空间索引,myisam支持

* 全文索引myisam与innodb均支持

#### 常见的b+tree索引优化策略

* 在不考虑分组和排序时,由于存在最左前缀机制,所以一般将高选择性字段放在前面

* mysql虽然会对多个单列索引进行索引合并优化,但当多条件查询时仍然需要使用多列索引

* 由于索引是由多个字符串组合为单个字符串并进行排序的结果,所以会导致最左前缀机制,进而字符串的顺序会影响索引效率

* 当使用覆盖索引(即索引覆盖查询)时应当注意字段大小,以及查询条件是否合理

* 当使用索引进行排序时依旧需要注意满足最左前缀机制

* 由于数据更新时可能会同时更新索引,所以不使用的或者重复索引应当尽量清理,减少消耗

> https://blog.codinglabs.org/articles/theory-of-mysql-index.html
